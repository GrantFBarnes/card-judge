{{define "body"}} {{if not .HasAccess}}
<form hx-post="/api/access/lobby/{{.Lobby.Id}}" hx-target="find .htmx-result">
  <h3>Lobby: {{.Lobby.Name}}</h3>
  <p>You must provide the password to join lobby.</p>
  <input
    type="password"
    id="password"
    name="password"
    maxlength="255"
    placeholder="Enter Lobby Password"
    required="true"
    autofocus="true"
    autocomplete="off"
  />
  <br />
  <br />
  <div class="htmx-result"></div>
  <input type="submit" value="Submit" />
</form>
{{else}}
<script src="/static/js/lobby.js"></script>
<link rel="stylesheet" href="/static/css/lobby.css" />
<div id="lobby-grid-container">
  <div id="lobby-header">
    <span>Lobby: {{.Lobby.Name}}</span>
    {{if eq .Lobby.CreatedByPlayerId .Data.Player.Id}}
    <span
      class="clickable"
      onclick="document.getElementById('lobby-update-dialog').showModal()"
    >
      &#128393;
    </span>
    <dialog id="lobby-update-dialog">
      <div style="display: grid; grid-auto-flow: column">
        <div>
          <h3>Edit Lobby</h3>
        </div>
        <div>
          <div
            class="close-button"
            onclick="document.getElementById('lobby-update-dialog').close()"
          >
            &#10060;
          </div>
        </div>
      </div>
      <form
        hx-put="/api/lobby/{{.Lobby.Id}}/name"
        hx-target="find .htmx-result"
      >
        <h3>Set Lobby Name</h3>
        <p>Current Name: {{.Lobby.Name}}</p>
        <label for="setLobbyName">New Name:</label>
        <input
          type="text"
          id="setLobbyName"
          name="name"
          maxlength="255"
          placeholder="Enter Name"
          required="true"
          autocomplete="off"
        />
        <br />
        <br />
        <div class="htmx-result"></div>
        <input type="submit" value="Set Lobby Name" />
      </form>
      <form
        hx-put="/api/lobby/{{.Lobby.Id}}/password"
        hx-target="find .htmx-result"
      >
        <h3>Set Lobby Password</h3>
        <label for="newLobbyPassword">New Password:</label>
        <input
          type="password"
          id="newLobbyPassword"
          name="password"
          maxlength="255"
          placeholder="Enter Password"
          autocomplete="new-password"
        />
        <br />
        <label for="newLobbyPasswordConfirm">Confirm New Password:</label>
        <input
          type="password"
          id="newLobbyPasswordConfirm"
          name="passwordConfirm"
          maxlength="255"
          placeholder="Enter Password"
          autocomplete="off"
        />
        <br />
        <br />
        <div class="htmx-result"></div>
        <input type="submit" value="Set Lobby Password" />
      </form>
    </dialog>
    {{end}}
    <span
      hx-get="/api/lobby/{{.Lobby.Id}}/card-count"
      hx-trigger="load delay:1s, every 60s"
    ></span>
  </div>
  <div id="lobby-left-side">
    <h4>Player Hand</h4>
    <button
      hx-post="/api/lobby/{{.Lobby.Id}}/player/{{.Data.Player.Id}}/draw"
      hx-target="next div"
    >
      Draw
    </button>
    <div></div>
  </div>
  <div id="lobby-middle">Board</div>
  <div id="lobby-right-side">
    <div
      hx-get="/api/lobby/{{.Lobby.Id}}/player-wins"
      hx-trigger="load delay:5s, every 30s"
    ></div>
  </div>
  <div id="lobby-footer">
    <div id="lobby-chat-messages"></div>
    <form id="lobby-chat-form">
      <input
        id="lobby-chat-input"
        type="text"
        maxlength="255"
        placeholder="Send a message..."
      />
      <input id="lobby-chat-submit" type="submit" value="Send" />
    </form>
  </div>
</div>
{{end}} {{end}}
